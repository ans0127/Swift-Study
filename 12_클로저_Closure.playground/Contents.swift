import UIKit

/*======================================================================
 ν΄λ΅μ €
 - μ΄λ¦„μ΄ μ—†λ” ν•¨μ(μµλ…ν•¨μ)
 - ν•¨μμ™€ κΈ°λ¥μ€ μ™„μ „ν λ™μΌν•μ§€λ§ ν•νƒλ§ λ‹¤λ¥΄λ‹¤.
 - swift μ—μ„ μ¤‘κ΄„νΈ({ })λ” ν•¨μμ΄λ‹¤!!
 ======================================================================*/

//ν•¨μμ™€ ν΄λ΅μ €
var f : String = "function"

func myFunc(f: String)->(String){    //ν•¨μ
    return "hello \(f)"
}

let myf = {(f: String)->(String) in  //ν΄λ΅μ €
    return "hello \(f)"
}

let nth = {() -> (String) in
    return "nothing in out"
}

myFunc(f: "hi")
myf("λ²Όλ¦¬μ•λƒ¥")
nth()


/*======================================================================
 β¨ν΄λ΅μ €λ” ν•¨μλ¥Ό 1κΈ‰κ°μ²΄λ΅ μ·¨κΈ‰ν•λ‹¤.β¨
    π’ 1κΈ‰ κ°μ²΄μ 3κ°€μ§€ μλ―Έπ’ 
 - ν•¨μλ¥Ό λ³€μμ— ν• λ‹Ήν•  μ μλ‹¤.
 - νλΌλ―Έν„°λ΅ μ „λ‹¬μ΄ κ°€λ¥ν•λ‹¤.
 - ν•¨μμ—μ„ ν•¨μλ¥Ό returnν•  μ μλ‹¤.
 ======================================================================*/

// ν΄λ΅μ €λ¥Ό λ³€μμ— ν• λ‹Ήν•  μ μλ‹¤.
var cls = {(s:String)->(String) in
    return s + "!!!!!"
}

cls("λ²Όλ¦¬μ•Ό")



//ν΄λ΅μ €μ ν•νƒ
// - λ¦¬ν„΄ν•μ„ μƒλµν•  μ μλ‹¤.
var str = "λ²Όλ¦¬μ•Ό μ•ΌμΉ"

let ac = {(str : String) in
    return str + "!!!!!"
}

let ac2 : (String) -> (String) = {(str) in  //νƒ€μ…μ¶”λ΅ μ΄ κ°€λ¥ν•  κ²½μ° inputνƒ€μ…λ„ μƒλµ κ°€λ¥ν•λ‹¤.
    return str + "????"
}

let ac3 = {         //input outputμ΄ μ—†μ–΄λ„ returnκ°’μ΄ string μ΄λΌλ” κ²ƒμ„ μ»΄νμΌλ¬κ°€ μ•κΈ° λ•λ¬Έμ— νƒ€μ…μ¶”λ΅ μ΄ κ°€λ¥ν•λ‹¤.
    print("λ²Όλ¦¬κ°€ μ•ΌμΉ")
}


ac("λ²Όλ¦¬μ•ΌμΉ")
ac2("λ²Όλ¦¬μ•Όμ•ΌμΉ")
ac3()

//- νλΌλ―Έν„°μ νƒ€μ…λ„ μƒλµμ΄ κ°€λ¥ν•λ‹¤.
let ac4 = { str in
    return str + "?!!???!?!?"
}
ac4("μ•ΌμΉλ²Όλ¦¬μ•ΌμΉ")




/*======================================================================
 β¨β¨β¨β¨β¨β¨β¨β¨ν΄λ΅μ €λ¥Ό μ‚¬μ©ν•λ” μ΄μ  β¨β¨β¨β¨β¨β¨β¨β¨
 - ν•¨μμ μ΄λ¦„μ΄ μ—†λ” μ΄μ : ν•¨μλ¥Ό μ‹¤ν–‰ ν•  λ• νλΌλ―Έν„°λ΅ μ‚¬μ©λλ” ν•νƒμ΄κΈ° λ•λ¬Έμ— μ΄λ¦„μ΄ ν•„μ”μ—†λ‹¤.
 ======================================================================*/

//1. ν΄λ΅μ €λ¥Ό νλΌλ―Έν„°λ΅ λ°›λ” ν•¨μ μ •μ
func closureParamFunction(closure : () -> ()){      //2.νλΌλ―Έν„°λ΅  printClosureFuncInVar λμ§
    print("λ²Όλ¦¬κ°€ μ•ΌμΉν•κ³  μΈκΈ° μ‹μ‘!!")                   //3.(*print)closureParamFunction μ‹¤ν–‰μ‹ μ²«μ¤„ μ‹¤ν–‰ & print
    closure()                                       //4.closureν•¨μ μ‹¤ν–‰ - νλΌλ―Έν„°λ΅ λ°›μ€ printClosureFuncInVar μ‹¤ν–‰
    
}

//2.ν΄λ΅μ € ν•¨μ μ •μ---------------------------------
func printSwiftFunction(){
    print("λ²Όλ¦¬κ°€ swift functionμ—μ„ μ•ΌμΉ")
}

var printClosureFuncInVar = { () -> () in
    print("λ²Όλ¦¬κ°€ closure functionμ—μ„ μ•ΌμΉ")          //5.(*print) printClosureFuncInVar μ‹¤ν–‰ - print
}
//-----------------------------------------------



//3.ν•¨μλ¥Ό νλΌλ―Έν„°μ— λ„£μΌλ©΄μ„ μ‹¤ν–‰
print("ν•¨μλ¥Ό νλΌλ―Έν„°λ΅ λ„£μΌλ©΄μ„ μ „λ‹¬---------------------------")
closureParamFunction(closure: printSwiftFunction)       //ν•¨μμ „λ‹¬
print("ν΄λ΅μ €ν•¨μ νλΌλ―Έν„°λ΅ λ„£μΌλ©΄μ„ μ „λ‹¬-----------------------")
closureParamFunction(closure: printClosureFuncInVar)    //ν΄λ΅μ €ν•¨μ μ „λ‹¬      1.closureParamFunction ν•¨μ μ‹¤ν–‰




//4. ν΄λ΅μ €λ¥Ό μ •μν•λ©΄μ„ ν•¨μλ¥Ό νλΌλ―Έν„°μ— λ„£μΌλ©΄μ„ μ‹¤ν–‰
print("π’  -- λ³΄ν†µ ν΄λ΅μ € ν•¨μλ¥Ό μ •μν•λ©΄μ„ μ „λ‹¬ν•λ” λ°©μ‹μΌλ΅ μ‚¬μ©λλ‹¤ -- π’ ")
closureParamFunction(closure: {
    print("λ²Όλ¦¬κ°€ μ •μλλ©΄μ„ μ „λ‹¬λΌμ©")    //β¨λ³΄ν†µ μ΄λ°μ‹μΌλ΅ μ •μλ¥Ό ν•λ©΄μ„ μ „λ‹¬λλ‹¤!β¨
})
/*=============================================================
 Callbackν•¨μ : ν•¨μ μ‹¤ν–‰ μ‹ νλΌλ―Έν„°λ΅ μ „λ‹¬ν•λ” ν•¨μ
               ex.{ print("λ²Όλ¦¬κ°€ μ •μλλ©΄μ„ μ „λ‹¬λΌμ©") }
 =============================================================*/




/*==============================================================
 ν΄λ΅μ €λ¥Ό μ‚¬μ©ν•λ” μ΄μ  : μ‚¬ν›„μ  μ²λ¦¬κ°€ κ°€λ¥ν•λ‹¤.
 μ‚¬ν›„μ  μ²λ¦¬λ€?
          :ν΄λ΅μ €ν•¨μμ—μ„ κ°’μ„ λ°›μ•„μ„, -> ν΄λ΅μ €λ¥Ό νλΌλ―Έν„°λ΅ λ°›λ” ν•¨μμ •μν•λ” κ³³μ—μ„ κ³„μ‚° ν›„ ->κ³„μ‚°κ²°κ³Όλ¥Ό ν΄λ΅μ €ν•¨μλ΅ μ „λ‹¬ν•λ” λ°©μ‹
          :ν™μ©λ„κ°€ λμ–΄λ‚λ‹¤.
 ==============================================================*/
//μμ (1)-----------------------------------------------------------
//ν΄λ΅μ €λ¥Ό νλΌλ―Έν„°λ΅ λ°›λ” ν•¨μμ •μ
func closure01( a: Int, b: Int, closure001: (Int) -> Void){
    let c = a + b
//    closure001(c)
}

//ν΄λ΅μ €ν•¨μ
closure01(a: 1, b: 1, closure001: { abc in
    print("λ²Όλ¦¬μ•ΌμΉ \(abc)")
})

print("μμ 2=========================")
//μμ (2)-----------------------------------------------------------
//ν΄λ΅μ €λ¥Ό νλΌλ―Έν„°λ΅ λ°›λ” ν•¨μμ •μ
func closure02(a: Int, b:Int, closure002: (Int) -> Void){
    let c = a + b
    closure002(c)
}

closure02(a: 3, b: 4, closure002: { n in       //3+4 λ¥Ό λ‚΄λ¶€μ μΌλ΅ ν•κ³ , n μ— 7μ„ μ „λ‹¬ ...>7μ„ μ¶λ ¥
     print(" μ•ΌμΉ? : \(n)")
})



//ν•¨μμ μ •μ--------------->>>>>>>μ΄λ¶€λ¶„μ„ μ μ΄ν•΄ν•μ!!!!!!!
func perform(cl: () -> ()){
    print("μ‹μ‘")
    cl()
    print("λ—")
}

perform(cl:{
    print("μ¤‘κ°„")
})
//ν•¨μμ μ •μ--------------->>>>>>>


/*======================================================================
 β¨β¨β¨β¨β¨β¨β¨β¨ν΄λ΅μ €μ λ¬Έλ²• μµμ ν™”β¨β¨β¨β¨β¨β¨β¨β¨
 ======================================================================*/
// π’νΈλ μΌλ§(trailling:κΌ¬λ¦¬) ν›„ν–‰ν΄λ΅μ € :  ν•¨μμ λ§μ§€λ§‰(κΌ¬λ¦¬)μ— ν΄λ΅μ €κ°€ μ‹¤ν–‰λλ” κ²½μ° ν•¨μμ μ†κ΄„νΈ μƒλµ κ°€λ¥.


func traillFunc(cl:()->Void){
    print("λ²Όλ¦¬κ°€ ν•λ² μ•ΌμΉ")
    cl()
}

//1λ‹¨κ³„ μ›λν•νƒ
traillFunc(cl:{
    print("λ²Όλ¦¬ κΌ¬λ¦¬κ°€ μ•ΌμΉ1")   //λ²Όλ¦¬κ°€ ν•λ² μ•ΌμΉ   λ²Όλ¦¬ κΌ¬λ¦¬κ°€ μ•ΌμΉ
})

//2λ‹¨κ³„ μ†κ΄„νΈλ¥Ό κ°€μ Έμ™€μ„ μ•μ—μ„ λ‹«λ” ν•νƒ (κ°λ°μλ“¤μ΄ }λ’¤μ— λ‹«λ”κ±° κ³„μ† κΉλ¨ΉμΌλ‹κΉ..)
traillFunc(cl: ){
    print("λ²Όλ¦¬ κΌ¬λ¦¬κ°€ μ•ΌμΉ2")   //λ²Όλ¦¬κ°€ ν•λ² μ•ΌμΉ   λ²Όλ¦¬ κΌ¬λ¦¬κ°€ μ•ΌμΉ2
}

traillFunc( ){        //μ•„κ·λ¨ΌνΈ μƒλµ κ°€λ¥
    print("λ²Όλ¦¬ κΌ¬λ¦¬κ°€ μ•ΌμΉ22")   //λ²Όλ¦¬κ°€ ν•λ² μ•ΌμΉ   λ²Όλ¦¬ κΌ¬λ¦¬κ°€ μ•ΌμΉ22
}

//3λ‹¨κ³„ μ†κ΄„νΈλ¥Ό μƒλµν• ν•νƒ - ν•¨μλ¥Ό μ‚¬μ©ν•λ©΄μ„ ν΄λ΅μ €λ¥Ό μΈν’‹μΌλ΅ λμ§€κ³  μκµ¬λ‚!
traillFunc{
    print("λ²Όλ¦¬ κΌ¬λ¦¬κ°€ μ•ΌμΉ3")    //λ²Όλ¦¬κ°€ ν•λ² μ•ΌμΉ   λ²Όλ¦¬ κΌ¬λ¦¬κ°€ μ•ΌμΉ3
}




/**
 $0 = μ²«λ²μ§Έ νλΌλ―Έν„°
 $1 = λ‘λ²μ§Έ νλΌλ―Έν„°
 $2 = μ„Έλ²μ§Έ νλΌλ―Έν„°*/
//π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ ν΄λ΅μ € λ¬Έλ²•μ„ μµμ ν™” ν•λ” κ³Όμ •π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ 
//ν•¨μ μ •μ
func pClosure(p : (String) -> Int){
    p("byuri")
}

//λ¬Έλ²• μµμ ν™” μ‹μ‘
//1.ν΄λ΅μ € ν•¨μ
pClosure(p: { (br : String) in
    return br.count
})
//2.νƒ€μ…μ¶”λ΅  - νƒ€μ…μƒλµ
pClosure(p: { br in    //ν•¨μμ μ •μμ— String μΌλ΅ νƒ€μ… μ¶”λ΅ κ°€λ¥. -> String μƒλµ
    return br.count
})
//3. λ¦¬ν„΄ μƒλµ
pClosure(p: { br in
    br.count            //ν•μ¤„μΈ κ²½μ° λ¦¬ν„΄ μ•μ μ–΄λ„ λ¨.
})
//4.μ•„κ·λ¨ΌνΈ μ΄λ¦„ μƒλµ
pClosure (p: {
    $0.count
})
//5. μ•„κ·λ¨ΌνΈ μ΄λ¦„μ΄ μƒλµλλ©΄ λ΅μ§μƒ μ‚¬μ©ν•  μ μ—†κΈ° λ•λ¬Έμ— $0,$1, $2..λ“±μΌλ΅ μ•„κ·λ¨ΌνΈ μ‚¬μ© κ°€λ¥.
pClosure(){
    $0.count
}
//6. μ†κ΄„νΈ μƒλµ κ°€λ¥  -- μµμΆ…ν•νƒ
pClosure{$0.count}
//π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ π’ 



//escaping ν‚¤μ›λ“==================================================

//ν΄λ΅μ €λ¥Ό λ‹¨μ μ‹¤ν–‰ ( non escaping ) --------------------------------
//μ›μΉ™μ μΌλ΅λ” ν•¨μλ¥Ό μΆ…λ£ν•λ©΄ ν΄λ΅μ €λ„ μΆ…λ£λ¨
func performEscaping1(closure : () -> ()){
    print("print start")
    closure()
}

performEscaping1{
    print("printing....")
    print("print end")
}


/*============================================================
μ™ escaping ν‚¤μ›λ“κ°€ ν•„μ”ν• κΉ?
 - μ–΄λ–¤ ν•¨μμ λ‚΄λ¶€μ— μλ” ν΄λ΅μ €λ¥Ό μ™Έλ¶€ λ³€μμ— μ €μ¥ν•λ‹¤. escaping ν•¨μλ¥Ό ν†µν•΄μ„ [λ°›μ€ ν•¨μ]κ°€ μ™Έλ¶€λ΅ νƒμ¶ν• κ±°μ•Ό! λΌκ³  μ•λ ¤μ£Όκ³  μλ” κ²ƒμ„.
 - λΉ„λ™κΈ° μ½”λ“ (GCD) μ μ‚¬μ© -> μλ¥Όλ“¤μ–΄ 1μ΄ λ’¤ ν΄λ΅μ € ν•¨μλ¥Ό μ‹¤ν–‰ν•κ³  μ‹¶μ„ κ²½μ°, heapμμ—­μ— μ €μ¥ν•΄μ„ μ‚¬μ©ν•΄μ•Ό ν•λ‹¤.
 - ν•¨μκ°€ μΆ…λ£λΌλ„ ν΄λ΅μ € ν•¨μλ¥Ό μ μ§€μ‹ν‚¨λ‹¤.
============================================================*/

//input, output νƒ€μ…μ΄ voidμΈ ν•¨μλ¥Ό μ„ μ–Έν•΄μ„ λ³€μμ— λ„£μ
var aSaveFunction: () -> () = { print("μ¶λ ¥")}
aSaveFunction()       //μ¶λ ¥μ΄ ν”„λ¦°νΈλ¨

func performEscaping2( cls : @escaping () -> ()) {   //1. μ™Έλ¶€μ— μλ” ν•¨μλ¥Ό λ°›μ•„μ„, cls μ— λ„£μ€λ‹¤μ
    aSaveFunction = cls             //2. cls λ¥Ό aSaveFunction λ³€μμ— λ„£μ.
    //cls()  <- non escaping λ°©μ‹μ€ μ΄λ ‡κ² λ°”λ΅ clsλ¥Ό νΈμ¶ν•λ‹¤
}


performEscaping2{ print("@escaping ν‚¤μ›λ“λ¥Ό μ‚¬μ©ν•΄μ„ μ¶λ ¥") }  //μ΄λ€λ΅λ” μ¶λ ¥λμ§€ μ•μ . μ΄ ν•¨μλ¥Ό aSaveFunctionμ— μ¶λ ¥ν•λ” κ²ƒ λΏμ΄κΈ°λ•λ¬Έμ— ..

aSaveFunction()



//=============================================================================================




